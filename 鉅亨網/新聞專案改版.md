## 畫面
* [Zepilin列表](https://app.zeplin.io/project/576287bda89e8aa7045cfba5/screen/645db4a95b9d821337078288)
* [Zeplin內頁](https://app.zeplin.io/project/576287bda89e8aa7045cfba5/screen/6451d7ffb5da8d26449e90da)

## 目錄結構
```
- workspace
	- apps/
		- fe-news
	- libs/
		- fe-common-ui
		- fe-common-utils
```

## Monorepo
* 建立workspace:  [create-nx-workspace](https://nx.dev/packages/nx/documents/create-nx-workspace)
```sh
npx create-nx-workspace@latest
--preset=next
--packageManager=pnpm
```
* 目錄結構
```
- workspace
	- apps
	- libs
	- tools
```
* 新增專案到apps
	* @nx/next:app → nextjs模板
```sh
pnpm nx g @nx/next:app fe-news
```
* 新增專案到libs
	* https://nx.dev/packages/react/generators/library
```
pnpm nx g @nx/react:lib fe-common
```
* 新增元件模板到fe-news專案下
```
pnpm nx g @nx/react:component header --project=fe-news
```
* 新增元件到fe-common-ui下
```
pnpm nx g @nx/react:component section --project=fe-common-ui
```
* 刪除專案
```
pnpm nx g rm fe-news-e2e
pnpm nx g rm fe-news
```
* 重新命名專案
```
pnpm nx g mv --project <old-name> <new-name>
```
* 起多個專案
```sh
pnpm nx run-many -t start -p fe-news fe-common-ui
# -t (target)
# -p (project)
```

## CSS Library(Linaria)
* [callstack/linaria: Zero-runtime CSS in JS library](https://github.com/callstack/linaria)
```sh
pnpm install next-with-linaria @linaria/babel-preset @linaria/core @linaria/react
```
* [next-with-linaria](https://github.com/dlehmhus/next-with-linaria)
```ts
// next.config.ts
const withLinaria = require('next-with-linaria');
const plugins = [
  withNx,
  withLinaria,
];
```
* 語法
```ts
import { styled } from 'linaria/react';
import { css } from 'linaria';

const Title = styled.h1`
  font-size: 36px;
`
```
```html
<span
  className={css`
	color: red;
  `}
>
  Hello there
</span>
```

## 開發
* 可執行的指令定義在project.json
* dev
	* 新聞列表API CORS問題要加(--hostname=0.0.0.0) → `dev.beta.cnyes.cool`
```sh
pnpm nx serve fe-news --hostname=0.0.0.0
```

## Next13
* SSR 
	* [Data Fetching: Fetching | Next.js](https://nextjs.org/docs/app/building-your-application/data-fetching/fetching)

## Lint
* [eslint-config-airbnb-typescript - npm](https://www.npmjs.com/package/eslint-config-airbnb-typescript)
	* 修改`.eslintrc.json`

## Infinite-loader
* [example](https://codesandbox.io/s/react-virtualized-infiniteloader-p7w36?file=/src/App.js)
* [Prefetching infinite queries · TanStack/query · Discussion #826](https://github.com/TanStack/query/discussions/826)

## fe-common-ui
* 安裝storybook
	* https://nx.dev/packages/storybook
```
pnpm nx g @nx/storybook:configuration fe-common-ui --uiFramework=@storybook/react-vite  --tsConfiguration=true
```
* 在fe-common-ui下新增樣板
```
pnpm nx g @nx/react:component button --project=fe-common-ui
```
* 為component新增stories
```
pnpm nx g @nx/react:stories --project=fe-common-ui
```

## fe-common-utils
```
- libs
	- fe-common-utils
		- errorHandler
		- time
```

* ErrorHandler
	* [Handling errors like a pro in TypeScript | by Kolby Sisk | Udacity Eng & Data](https://engineering.udacity.com/handling-errors-like-a-pro-in-typescript-d7a314ad4991)

## 其他

* 打開全部專案關係圖
```
pnpm nx graph
```

## Reference
* Package Manager 
	* [Fast, disk space efficient package manager | pnpm](https://pnpm.io/)
* Monorepo
	* [Package-Based Monorepo | Nx](https://nx.dev/tutorials/package-based-repo-tutorial)
	* [Pnpm and Nx monorepo. Part 1 | Javier Brea](https://www.javierbrea.com/blog/pnpm-nx-monorepo-01/)
	* [Create a Shared React Library in an Nx Workspace | egghead.io](https://egghead.io/lessons/react-create-a-shared-react-library-in-an-nx-workspace)
		* 新增一個ui library
		* `tsconfig.base.json`
			* "experimentalDecorators": true
* Linaria
	* [Airbnb’s Trip to Linaria](https://medium.com/airbnb-engineering/airbnbs-trip-to-linaria-dc169230bd12)
